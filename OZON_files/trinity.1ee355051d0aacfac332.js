(self.webpackChunk_ozon_ozon_ru=self.webpackChunk_ozon_ozon_ru||[]).push([["trinity"],{"2b41b":(t,e,r)=>{"use strict";r.d(e,{P:()=>h,Z:()=>f});var o,n=r("f9266"),c=r("2f977"),y=function(){return y=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},y.apply(this,arguments)},l=function(t){var s="function"==typeof Symbol&&Symbol.iterator,e=s&&t[s],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")};!function(t){t.DESIRED="v1",t.GLUED="v2"}(o||(o={}));var d={cell:{},slice:{}},h=function(){function t(){this.trackingPayloads={}}return t.prototype.setVersion=function(t){this.trackingVersion=t},t.prototype.setTrackingPayloads=function(t){this.trackingPayloads=t},t.prototype.send=function(t,e,r,l){var d=this;if(void 0===r&&(r={}),void 0===l&&(l=!1),e){var h,f=this.trackingVersion===o.GLUED,v=e.key,m=e.actionType,k=e.nested,P=void 0===k?[]:k;if(!0===l&&!1===f){h=(0,n.generateClickHouseUUID)();var w=e.sliceKey,I=y(y({actionType:m,uuid:h},t),{custom:r});v&&(I.cellToken=v),w&&(I.sliceToken=w),c.yD.sendTrinityEvent(I)}var E=t.widgetToken,T=f?this.composeGluedPayload(v):this.composePayloadBySeparateKeys(e,E),O=y(y({},T),{custom:r});O.widget||(O.widget=this.getPayloadByKey(E));var C={actionType:m,widget:O.widget,composer:{cell:O.cell,slice:O.slice,custom:O.custom}};h&&(C.uuid=h),c.yD.sendComposerEvent(C),Array.isArray(P)&&P.length&&P.forEach((function(e){return d.send(t,e,{},l)}))}},t.prototype.composeGluedPayload=function(t){var e,r,o=this.getPayloadByKey(t),n=y({},d);try{for(var c=l(Object.keys(o)),h=c.next();!h.done;h=c.next()){var f=h.value;n[f]=this.getPayloadByKey(o[f])}}catch(t){e={error:t}}finally{try{h&&!h.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}return n},t.prototype.composePayloadBySeparateKeys=function(t,e){var r=t.key,o=t.sliceKey;return{cell:this.getPayloadByKey(r),slice:this.getPayloadByKey(o),widget:this.getPayloadByKey(e)}},t.prototype.getPayloadByKey=function(t){if(!t||!this.trackingPayloads[t])return{};try{return JSON.parse(this.trackingPayloads[t])}catch(t){return{}}},t}(),f=new h},"2f977":(t,e,r)=>{"use strict";r.d(e,{Y$:()=>o,yD:()=>d,rr:()=>n.rr});var o,n=r("bd7eb"),c=r("54922"),y=r("4dffc"),l=function(){return l=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},l.apply(this,arguments)};!function(t){t.PAGE_VIEW="page_view"}(o||(o={}));var d=new(function(){function t(){this.eventsCache=[],this.pageInit=!1,this.tracker=new n.fs,this.dataLayer=new c.WJ}return t.prototype.init=function(t,e){this.setState(t),this.tracker.init(e)},t.prototype.setState=function(t){this.state=Object.assign({},t)},t.prototype.sendTrackerPageClose=function(t){void 0===t&&(t={}),this.tracker.sendPageClose(t)},t.prototype.sendTrackerPageView=function(t){void 0===t&&(t={}),this.tracker.sendPageView(t)},t.prototype.sendEvent=function(t){var e=l(l({},t),(0,y.mK)(this.state));this.tracker.sendEvent(e)},t.prototype.sendComposerEvent=function(t){var e=(0,y.DE)(this.state,t);this.tracker.sendComposerEvent(e),this.pageInit?this.dataLayer.pushEcommerce(e,this.state.ecommerceExperiments):this.eventsCache.push(e)},t.prototype.sendTrinityEvent=function(t){var e=(0,y.tF)(this.state,t);this.tracker.sendTrinityEvent(e)},t.prototype.setPageInit=function(t){this.pageInit=t},t.prototype.send=function(t,e){var r={actionType:t,widget:e.widget,composer:{cell:e.cell,slice:e.slice,custom:e.custom}};this.sendComposerEvent(r)},t.prototype.sendDLPageEvents=function(t,e,r,n){this.dataLayer.pushPageInit(t,e,r),this.dataLayer.pushGtmStart(),n&&n===o.PAGE_VIEW&&this.dataLayer.pushPageView(),this.pageInit=!0},t.prototype.sendDLWidgetsEvents=function(){if(this.eventsCache.length)for(var i=0;i<=this.eventsCache.length;i++){var t=this.eventsCache[i];t&&this.dataLayer.pushEcommerce(t,this.state.ecommerceExperiments)}},t.prototype.reinitDataLayer=function(t){this.dataLayer.reinit(t),this.eventsCache=[],this.pageInit=!1},Object.defineProperty(t.prototype,"pageViewId",{get:function(){return this.tracker.getPageViewId()},enumerable:!0,configurable:!0}),t}())},"4dffc":(t,e,r)=>{"use strict";r.d(e,{IN:()=>l,mK:()=>d,tF:()=>h,DE:()=>f});var o=r("8fd32"),n=r("ff287"),c=r.n(n),y=function(){return y=Object.assign||function(t){for(var s,i=1,e=arguments.length;i<e;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},y.apply(this,arguments)},l=function(t){return{page:{layoutId:t.layoutId,layoutVersion:t.layoutVersion,ruleId:t.ruleId,categoryId:t.categoryId,tagId:t.tagId,sku:t.sku,highlightId:t.highlightId,sellerId:t.sellerId,brandId:t.brandId}}},d=function(t){var e=m(t,"layoutTrackingInfo")||{};return{attributes:{deviceType:e.deviceType,platform:e.platform,templateType:e.templateType},user:{isBot:c()(t,"browser.isBot")||!1}}},h=function(t,e){void 0===e&&(e={});var r=v(e.custom);return y(y({},e),{attributes:y(y({},e.attributes),d(t).attributes),custom:r})},f=function(t,e){void 0===e&&(e={});var r=m(t,"layoutTrackingInfo")||{},n="string"==typeof e.widget?JSON.parse(e.widget):e.widget,c="object"===(0,o.Z)(e.composer)?"string"==typeof e.composer.slice?JSON.parse(e.composer.slice):e.composer.slice:void 0,h="object"===(0,o.Z)(e.composer)?"string"==typeof e.composer.cell?JSON.parse(e.composer.cell):e.composer.cell:void 0,f="object"===(0,o.Z)(e.composer)?v(e.composer.custom):void 0,k=c||h||f?{slice:c,cell:h,custom:f}:void 0;return y(y(y(y({},e),{attributes:y(y({},e.attributes),d(t).attributes)}),l(r)),{widget:n,composer:k})},v=function(t){return"boolean"==typeof t?{}:"object"===(0,o.Z)(t)?t:void 0};function m(t,path){var object=c()(t,path);return object&&JSON.parse(JSON.stringify(object))}}}]);